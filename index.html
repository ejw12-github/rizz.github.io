<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FTC Team Scouting</title>
  <style>
    :root {
      --bg-color: #121212;
      --text-color: #f0f0f0;
      --box-bg: #1e1e1e;
    }

    body.light {
      --bg-color: #f0f0f0;
      --text-color: #121212;
      --box-bg: #ffffff;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 2rem;
      text-align: center;
      transition: background 0.3s, color 0.3s;
    }

    h1 {
      margin-bottom: 2rem;
    }

    .switch {
      font-size: 17px;
      position: absolute;
      top: 1rem;
      left: 1rem;
      width: 4em;
      height: 2.2em;
      border-radius: 30px;
      z-index: 999;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #2a2a2a;
      transition: 0.4s;
      border-radius: 30px;
      overflow: hidden;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 1.2em;
      width: 1.2em;
      border-radius: 20px;
      left: 0.5em;
      bottom: 0.5em;
      transition: 0.4s;
      transition-timing-function: cubic-bezier(0.81, -0.04, 0.38, 1.5);
      box-shadow: inset 8px -4px 0px 0px #fff;
    }

    .switch input:checked + .slider {
      background-color: #00a6ff;
    }

    .switch input:checked + .slider:before {
      transform: translateX(1.8em);
      box-shadow: inset 15px -4px 0px 15px #ffcf48;
    }

    .star {
      background-color: #fff;
      border-radius: 50%;
      position: absolute;
      width: 5px;
      transition: all 0.4s;
      height: 5px;
    }

    .star_1 {
      left: 2.5em;
      top: 0.5em;
    }

    .star_2 {
      left: 2.2em;
      top: 1.2em;
    }

    .star_3 {
      left: 3em;
      top: 0.9em;
    }

    .switch input:checked ~ .slider .star {
      opacity: 0;
    }

    .cloud {
      width: 3.5em;
      position: absolute;
      bottom: -1.4em;
      left: -1.1em;
      opacity: 0;
      transition: all 0.4s;
    }

    .switch input:checked ~ .slider .cloud {
      opacity: 1;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 2rem;
    }

    .form {
      --width-of-input: 250px;
      position: relative;
      width: var(--width-of-input);
    }

    .input {
      color: var(--text-color);
      font-size: 0.9rem;
      background-color: transparent;
      width: 100%;
      padding-inline: 0.5em;
      padding-block: 0.7em;
      border: none;
      border-bottom: 1px solid rgba(221, 221, 221, 0.39);
      text-align: center;
    }

    .input-border {
      position: absolute;
      background: #5891ff;
      width: 100%;
      height: 2px;
      bottom: 0;
      left: 0;
      transition: 0.3s;
      transform-origin: left;
      /* Fix: always extend full width, scaleX controlled */
      transform: scaleX(0);
    }

    input:hover {
      background: #4985e01f;
    }

    input:focus {
      outline: none;
    }

    input:focus ~ .input-border {
      transform: scaleX(1);
    }

    button {
      align-items: center;
      background-image: linear-gradient(144deg, #af40ff, #5b42f3 50%, #00ddeb);
      border: 0;
      border-radius: 8px;
      box-shadow: rgba(151, 65, 252, 0.2) 0 10px 20px -5px;
      color: #fff;
      font-size: 14px;
      margin-top: 1rem;
      padding: 2px;
      display: flex;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 120px;
    }

    button span {
      background-color: rgb(5, 6, 45);
      padding: 10px 16px;
      border-radius: 6px;
      width: 100%;
      transition: 300ms;
    }

    button:hover span {
      background: none;
    }

    button:active {
      transform: scale(0.95);
    }

    .box {
      background: var(--box-bg);
      padding: 1rem 1.5rem;
      margin: 1rem 0;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      transition: background 0.3s;
      text-align: left;
    }

    .box h2 {
      margin-top: 0;
      font-size: 1.2rem;
      border-bottom: 1px solid #444;
      padding-bottom: 0.5rem;
    }

    .box ul {
      list-style-type: none;
      padding-left: 0;
    }

    .box li {
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <label class="switch">
    <input id="checkbox" type="checkbox" checked />
    <span class="slider">
      <div class="star star_1"></div>
      <div class="star star_2"></div>
      <div class="star star_3"></div>
      <svg viewBox="0 0 16 16" class="cloud" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
        <path fill="#fff"
          d="m391.84 540.91c-.421-.329-.949-.524-1.523-.524-1.351 0-2.451 1.084-2.485 2.435-1.395.526-2.388 1.88-2.388 3.466 0 1.874 1.385 3.423 3.182 3.667v.034h12.73v-.006c1.775-.104 3.182-1.584 3.182-3.395 0-1.747-1.309-3.186-2.994-3.379.007-.106.011-.214.011-.322 0-2.707-2.271-4.901-5.072-4.901-2.073 0-3.856 1.202-4.643 2.925"/>
      </svg>
    </span>
  </label>

  <h1>FTC Team Scouting</h1>

  <div class="input-group">
    <div class="form">
      <input id="teamNumber" class="input" placeholder="Enter team number" required type="text" />
      <span class="input-border"></span>
    </div>
    <button onclick="getTeamInsights()"><span>Generate Statistics</span></button>
  </div>

  <div id="results"></div>
  
  <script>
    async function getTeamInsights() {
      const teamNumber = document.getElementById('teamNumber').value.trim();
      if (!teamNumber) {
        alert('Please enter a team number');
        return;
      }
  
      const query = `
        query {
          teamByNumber(number: ${teamNumber}) {
            quickStats(season: 2024) {
              tot {
                rank
                value
              }
              auto {
                rank
                value
              }
              dc {
                rank
                value
              }
              eg {
                rank
                value
              }
              count
            }
          }
        }
      `;
  
      try {
        const response = await fetch('https://ftc-api.firstinspires.org/graphql', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query }),
        });
  
        const json = await response.json();
  
        if (!json.data || !json.data.teamByNumber || !json.data.teamByNumber.quickStats) {
          document.getElementById('results').innerHTML = `<p>No data found for team ${teamNumber}.</p>`;
          return;
        }
  
        const stats = json.data.teamByNumber.quickStats;
        const totalTeams = stats.count;
  
        function formatRank(rank) {
          if (rank === 1) return `ðŸ‘‘ 1st`;
          if (rank === 2) return `2nd`;
          if (rank === 3) return `3rd`;
          return `${rank}th`;
        }
  
        function calcPercentile(rank, count) {
          return ((count - rank) / count) * 100;
        }
  
        function formatValue(value) {
          return Number(value).toFixed(2);
        }
  
        const categories = ['tot', 'auto', 'dc', 'eg'];
  
        let html = `<div class="box"><h2>Team ${teamNumber} Stats (2024)</h2><ul>`;
  
        for (const cat of categories) {
          const catStats = stats[cat];
          if (!catStats) continue;
  
          const rank = catStats.rank;
          const value = formatValue(catStats.value);
          const ordinal = formatRank(rank);
          const percentile = calcPercentile(rank, totalTeams).toFixed(2);
  
          html += `<li><strong>${cat.toUpperCase()}:</strong> ${value} (${ordinal} / ${percentile}%)</li>`;
        }
  
        html += `</ul></div>`;
  
        document.getElementById('results').innerHTML = html;
  
      } catch (error) {
        document.getElementById('results').innerHTML = `<p>Error fetching data: ${error.message}</p>`;
      }
    }
  </script>

  
</body>
</html>
